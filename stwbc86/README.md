# STWBC86 Driver

## Requirements

This driver requires the STWBC86 wireless charger chip. This is present on the `STEVAL-WBC86TX` board.


------

## Description

This driver provides API to update STWBC86 firmware and configurations. The driver is written in C programming language and developed based way below:
1.	Platform independent driver which users could easily integrate the driver without any modification needed.
1.	Written in a way of clear and self-explainable sequences, as references to user if need to re-write the sequences in different code formatting.

The code documentation can be generated using the Doxygen tool.


------

## Hardware Setup
1. Connect a **5V** power supply to VRECT or VOUT
2. Connect the STWLC I2C pins to the master I2C bus.

------

## Source Code Integration
1. Include the driver files (.h and .c) and nvm_data.h which generated by Header Generator in GUI application.

2. Define platform functions and variables to be used by driver API. See below for the function definitions.

```
    int32_t platform_write(void *phandle, uint8_t *wbuf, int32_t wlen);
    int32_t platform_write_read(void *phandle, uint8_t *wbuf, int32_t wlen, uint8_t *rbuf, int32_t rlen);
    void platform_delay(uint32_t millisec);
    void *platform_alloc_mem(size_t size);
    void platform_free_mem(void *ptr);
```

3. Declare and initialize driver interfaces
- To use this driver, users need to declare and assign the platform functions to mandatory interfaces.

```
    /** stwlcxx is the used part number **/
    struct stwlcxx_dev stwbc86 = { 0 };

    stwbc86.bus_write = platform_write;
    stwbc86.bus_write_read = platform_write_read;
    stwbc86.mdelay = HAL_Delay;
    stwbc86.alloc_mem = malloc;
    stwbc86.free_mem = free;
```

- If user data is needed by the platform functions, initialize the phandle parameter.

```
    struct stmdev_platform platform = {
            .hi2c = &hi2c1,
            .huart = &huart3,
    };
    stwbc86.phandle = &platform;
```

- Optionally, users can print the log messages by initializing log parameters and set log_info to 1 to print more information logs.

```
    stwbc86.log = platform_log;
    stwbc86.log_info = 1;
```

------

**More Information: [ST wireless charger ICs](https://www.st.com/en/power-management/wireless-charger-ics)**

**Copyright (C) 2023 STMicroelectronics**